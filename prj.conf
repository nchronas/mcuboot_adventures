CONFIG_SIZE_OPTIMIZATIONS=y

# nothing here
CONFIG_BOOT_BANNER=y

# Enable console and printk()
CONFIG_PRINTK=y
CONFIG_STDOUT_CONSOLE=y

CONFIG_BOOTLOADER_MCUBOOT=y
# # Use the default MCUBoot PEM key file (BOOT_SIGNATURE_KEY_FILE)
CONFIG_MCUBOOT_SIGNATURE_KEY_FILE="bootloader/mcuboot/root-rsa-2048.pem"

CONFIG_REBOOT=y

CONFIG_SHELL=y
CONFIG_SHELL_BACKEND_SERIAL=y

CONFIG_SHELL_BACKENDS=y
CONFIG_SHELL_CMDS=y
CONFIG_SHELL_ECHO_STATUS=y

CONFIG_PRINTK=y
CONFIG_SHELL=y
CONFIG_LOG=y
CONFIG_INIT_STACKS=y
CONFIG_THREAD_STACK_INFO=y
CONFIG_KERNEL_SHELL=y
CONFIG_THREAD_MONITOR=y
# CONFIG_BOOT_BANNER=n
CONFIG_THREAD_NAME=y
CONFIG_DEVICE_SHELL=y
CONFIG_POSIX_CLOCK=y
# CONFIG_DATE_SHELL=y
# CONFIG_THREAD_RUNTIME_STATS=y
# CONFIG_THREAD_RUNTIME_STATS_USE_TIMING_FUNCTIONS=y
# CONFIG_STATS=y
# CONFIG_STATS_SHELL=y

# Haven't tried it yet
# CONFIG_MCUBOOT_GENERATE_UNSIGNED_IMAGE=y



CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_FLASH_PAGE_LAYOUT=y

CONFIG_FILE_SYSTEM=y
CONFIG_FILE_SYSTEM_LITTLEFS=y

CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_STREAM_FLASH=y
CONFIG_IMG_MANAGER=y
CONFIG_IMG_ENABLE_IMAGE_CHECK=y
CONFIG_MCUBOOT_IMG_MANAGER=y
CONFIG_IMG_BLOCK_BUF_SIZE=512

# CONFIG_DISK_ACCESS=y
# CONFIG_DISK_DRIVER_SDMMC=y
# CONFIG_SDMMC_STM32=y
# CONFIG_FAT_FILESYSTEM_ELM=y


# CONFIG_SDMMC_STM32_HWFC=y

# CONFIG_PM_DEVICE=n

# CONFIG_LOG_DEFAULT_LEVEL=3


# CONFIG_DEBUG=y
# CONFIG_FILE_SYSTEM_LITTLEFS=y
# CONFIG_FLASH=y
# CONFIG_FLASH_MAP=y
# CONFIG_FLASH_PAGE_LAYOUT=y

# CONFIG_COMMON_LIBC_MALLOC_ARENA_SIZE=8192

# Littlefs configuration to utilize QSPI operation
# CONFIG_FS_LITTLEFS_CACHE_SIZE=256
# CONFIG_FS_LITTLEFS_PROG_SIZE=32
# CONFIG_FS_LITTLEFS_READ_SIZE=32
# CONFIG_FS_LITTLEFS_LOOKAHEAD_SIZE=64
# CONFIG_FS_LITTLEFS_FC_HEAP_SIZE=8192

# CONFIG_NOCACHE_MEMORY=y

# CONFIG_DISK_DRIVER_SDMMC=y
# CONFIG_SDMMC_VOLUME_NAME="UNTITLED"

# CONFIG_DISK_ACCESS=y
# CONFIG_DISK_DRIVERS=y
# CONFIG_DISK_DRIVER_SDMMC=y

CONFIG_DEBUG=y
CONFIG_LOG=y
CONFIG_LOG_MODE_MINIMAL=y

# CONFIG_FILE_SYSTEM=y
# CONFIG_FILE_SYSTEM_LITTLEFS=y

# CONFIG_FS_LITTLEFS_BLK_DEV=y

CONFIG_NOCACHE_MEMORY=y

CONFIG_SDMMC_STM32_CLOCK_CHECK=n

CONFIG_GPIO=y
CONFIG_PINCTRL=y
CONFIG_CLOCK_CONTROL=y


# Nik test

# This file contains selected Kconfig options for the application.
# CONFIG_BOOTLOADER_MCUBOOT=y   
# nothing here
CONFIG_BOOT_BANNER=y

# Enable console and printk()
CONFIG_PRINTK=y
CONFIG_STDOUT_CONSOLE=y

# # Use the default MCUBoot PEM key file (BOOT_SIGNATURE_KEY_FILE)
CONFIG_MCUBOOT_SIGNATURE_KEY_FILE="bootloader/mcuboot/root-rsa-2048.pem"

# CONFIG_REBOOT=y

CONFIG_SHELL=y
CONFIG_SHELL_BACKEND_SERIAL=y

CONFIG_SHELL_BACKENDS=y
CONFIG_SHELL_CMDS=y
CONFIG_SHELL_ECHO_STATUS=y

CONFIG_PRINTK=y
CONFIG_SHELL=y
CONFIG_LOG=y
CONFIG_INIT_STACKS=y
CONFIG_THREAD_STACK_INFO=y
CONFIG_KERNEL_SHELL=y
CONFIG_THREAD_MONITOR=y
# CONFIG_BOOT_BANNER=n
CONFIG_THREAD_NAME=y
CONFIG_DEVICE_SHELL=y
CONFIG_POSIX_CLOCK=y
# CONFIG_DATE_SHELL=y
# CONFIG_THREAD_RUNTIME_STATS=y
# CONFIG_THREAD_RUNTIME_STATS_USE_TIMING_FUNCTIONS=y
# CONFIG_STATS=y
# CONFIG_STATS_SHELL=y

# Haven't tried it yet
# CONFIG_MCUBOOT_GENERATE_UNSIGNED_IMAGE=y



CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_FLASH_PAGE_LAYOUT=y

# CONFIG_FILE_SYSTEM=y
# CONFIG_FILE_SYSTEM_LITTLEFS=y

CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_STREAM_FLASH=y
CONFIG_IMG_MANAGER=y
CONFIG_IMG_ENABLE_IMAGE_CHECK=y
CONFIG_MCUBOOT_IMG_MANAGER=y
CONFIG_IMG_BLOCK_BUF_SIZE=512

# CONFIG_DISK_ACCESS=y
# CONFIG_DISK_DRIVER_SDMMC=y
# CONFIG_SDMMC_STM32=y
# CONFIG_FAT_FILESYSTEM_ELM=y


# CONFIG_SDMMC_STM32_HWFC=y

# CONFIG_PM_DEVICE=n

# CONFIG_LOG_DEFAULT_LEVEL=3


# CONFIG_DEBUG=y
# CONFIG_FILE_SYSTEM_LITTLEFS=y
CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_FLASH_PAGE_LAYOUT=y

# CONFIG_COMMON_LIBC_MALLOC_ARENA_SIZE=8192

# Littlefs configuration to utilize QSPI operation
# CONFIG_FS_LITTLEFS_CACHE_SIZE=256
# CONFIG_FS_LITTLEFS_PROG_SIZE=32
# CONFIG_FS_LITTLEFS_READ_SIZE=32
# CONFIG_FS_LITTLEFS_LOOKAHEAD_SIZE=64
# CONFIG_FS_LITTLEFS_FC_HEAP_SIZE=8192

CONFIG_NOCACHE_MEMORY=y

# CONFIG_DISK_DRIVER_SDMMC=y
# CONFIG_SDMMC_VOLUME_NAME="UNTITLED"

# CONFIG_DISK_ACCESS=y
# CONFIG_DISK_DRIVERS=y
# CONFIG_DISK_DRIVER_SDMMC=y

# CONFIG_DEBUG=y
CONFIG_LOG=y
CONFIG_LOG_MODE_MINIMAL=y

# CONFIG_FILE_SYSTEM=y
# CONFIG_FILE_SYSTEM_LITTLEFS=y

# CONFIG_FS_LITTLEFS_BLK_DEV=y

CONFIG_NOCACHE_MEMORY=y

# CONFIG_SDMMC_STM32_CLOCK_CHECK=n


# CONFIG_FILE_SYSTEM_SHELL=y

# CONFIG_FILE_SYSTEM_MKFS=y



###############################################################################
#  SatNOGS-COMMS MCU software
#
#  Copyright (C) 2022-2024, Libre Space Foundation <http://libre.space>
#
#  This program is free software: you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation, either version 3 of the License, or
#  (at your option) any later version.
#
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#
#  You should have received a copy of the GNU General Public License
#  along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
#  SPDX-License-Identifier: GNU General Public License v3.0 or later
###############################################################################

CONFIG_SOC_SERIES_STM32H7X=y
CONFIG_SOC_STM32H723XX=y

# Enable MPU and FPU
CONFIG_ARM_MPU=y
CONFIG_FPU=y

# Enable stack protection
# CONFIG_ENTROPY_GENERATOR=y
# CONFIG_HW_STACK_PROTECTION=y
# CONFIG_STACK_SENTINEL=y
# CONFIG_MPU_STACK_GUARD=y
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=1024
CONFIG_MAIN_STACK_SIZE=1024
CONFIG_IDLE_STACK_SIZE=512
CONFIG_STACK_USAGE=y


# Enable UART
CONFIG_SERIAL=y

# Console
CONFIG_CONSOLE=y
CONFIG_UART_CONSOLE=y

# Enable GPIO
CONFIG_GPIO=y

# Enable clocks
CONFIG_CLOCK_CONTROL=y

# Enable pin controller
CONFIG_PINCTRL=y

# Super useful configuration options for debugging
CONFIG_THREAD_NAME=y
# CONFIG_DEBUG_THREAD_INFO=y
# CONFIG_THREAD_MONITOR=y
CONFIG_INIT_STACKS=y
CONFIG_INIT_STACKS=y
CONFIG_THREAD_STACK_INFO=y
CONFIG_TRACING=y
CONFIG_TRACING_OBJECT_TRACKING=y
CONFIG_MEM_SLAB_TRACE_MAX_UTILIZATION=y
CONFIG_WAITQ_SCALABLE=y

# eMMC and littlefs related configuration
# CONFIG_DISK_ACCESS=y
# CONFIG_DISK_DRIVERS=y
# CONFIG_DISK_DRIVER_SDMMC=y
# CONFIG_MMC_STACK=y
# CONFIG_SDMMC_STM32_HWFC=y
# CONFIG_FILE_SYSTEM=y
# CONFIG_FILE_SYSTEM_LITTLEFS=y
# CONFIG_FS_LITTLEFS_BLK_DEV=y
# CONFIG_NOCACHE_MEMORY=y


# Segger RTT
CONFIG_CONSOLE=y
CONFIG_LOG_BACKEND_RTT=y
CONFIG_LOG_BACKEND_RTT_MODE_DROP=y
CONFIG_LOG_PRINTK=y
CONFIG_USE_SEGGER_RTT=y
CONFIG_RTT_CONSOLE=y
CONFIG_UART_CONSOLE=n
